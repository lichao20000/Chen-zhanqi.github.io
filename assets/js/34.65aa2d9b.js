(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{525:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"准备工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[t._v("#")]),t._v(" 准备工作")]),t._v(" "),a("ol",[a("li",[t._v("安装seleniumm")])]),t._v(" "),a("p",[a("code",[t._v("pip install selenium")])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("下载浏览器驱动")])]),t._v(" "),a("p",[t._v("Firefox浏览器驱动："),a("a",{attrs:{href:"https://github.com/mozilla/geckodriver/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("geckodriver"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Chrome浏览器驱动："),a("a",{attrs:{href:"https://sites.google.com/a/chromium.org/chromedriver/downloads",target:"_blank",rel:"noopener noreferrer"}},[t._v("chromedriver"),a("OutboundLink")],1),t._v(" , "),a("a",{attrs:{href:"https://npm.taobao.org/mirrors/chromedriver",target:"_blank",rel:"noopener noreferrer"}},[t._v("taobao备用地址"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("IE浏览器驱动："),a("a",{attrs:{href:"http://selenium-release.storage.googleapis.com/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("IEDriverServer"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Edge浏览器驱动："),a("a",{attrs:{href:"https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/",target:"_blank",rel:"noopener noreferrer"}},[t._v("MicrosoftWebDriver"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Opera浏览器驱动："),a("a",{attrs:{href:"https://github.com/operasoftware/operachromiumdriver/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("operadriver"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("PhantomJS浏览器驱动："),a("a",{attrs:{href:"https://phantomjs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("phantomjs"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("需要把浏览器驱动放入系统路径中，或者直接告知selenuim的驱动路径")]),t._v(" "),a("p",[t._v("启动浏览器，可以设置一些参数，比如无界面之类的，详细参考："),a("a",{attrs:{href:"http://xshanshan.cn/blogs/2019/20190530_selenium%E5%90%AF%E5%8A%A8Chrome%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0.html#%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0",target:"_blank",rel:"noopener noreferrer"}},[t._v("配置参数"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("可以测试是否正常使用:")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n\n\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Firefox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Firefox浏览器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# driver = webdriver.Firefox("驱动路径")')]),t._v("\n\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Chrome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Chrome浏览器")]),t._v("\n\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Ie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Internet Explorer浏览器")]),t._v("\n\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Edge"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Edge浏览器")]),t._v("\n\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Opera"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Opera浏览器")]),t._v("\n\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PhantomJS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# PhantomJS")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])]),a("h2",{attrs:{id:"元素定位"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#元素定位"}},[t._v("#")]),t._v(" 元素定位")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("find_element_by_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfind_element_by_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfind_element_by_class_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfind_element_by_tag_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfind_element_by_link_text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfind_element_by_partial_link_text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfind_element_by_xpath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfind_element_by_css_selector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("p",[a("strong",[t._v("在element变成elements就是找所有满足的条件，返回数组。")])]),t._v(" "),a("h2",{attrs:{id:"控制浏览器操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#控制浏览器操作"}},[t._v("#")]),t._v(" 控制浏览器操作")]),t._v(" "),a("ul",[a("li",[t._v("控制浏览器窗口大小")])]),t._v(" "),a("p",[a("code",[t._v("driver.set_window_size(480, 800)")])]),t._v(" "),a("ul",[a("li",[t._v("后退")])]),t._v(" "),a("p",[a("code",[t._v("driver.back()")])]),t._v(" "),a("ul",[a("li",[t._v("前进")])]),t._v(" "),a("p",[a("code",[t._v("driver.forward()")])]),t._v(" "),a("ul",[a("li",[t._v("刷新\n"),a("code",[t._v("driver.refresh()")])])]),t._v(" "),a("h2",{attrs:{id:"webelement常用方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webelement常用方法"}},[t._v("#")]),t._v(" Webelement常用方法")]),t._v(" "),a("ul",[a("li",[t._v("点击和输入")])]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kw"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clear"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 清除文本 ")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kw"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"selenium"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 模拟按键输入 ")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"su"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("click"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 单机元素")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("ul",[a("li",[t._v("提交\n可以在搜索框模拟回车操作")])]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("search_text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'kw'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" search_text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'selenium'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" search_text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("submit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("ul",[a("li",[t._v("其他")])]),t._v(" "),a("p",[a("strong",[t._v("size")]),t._v(": 返回元素的尺寸。")]),t._v(" "),a("p",[a("strong",[t._v("text")]),t._v(": 获取元素的文本。")]),t._v(" "),a("p",[a("strong",[t._v("get_attribute(name)")]),t._v(": 获得属性值。")]),t._v(" "),a("p",[a("strong",[t._v("is_displayed()")]),t._v(": 设置该元素是否用户可见。")]),t._v(" "),a("h2",{attrs:{id:"鼠标操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#鼠标操作"}},[t._v("#")]),t._v(" 鼠标操作")]),t._v(" "),a("p",[t._v("在 WebDriver 中， 将这些关于鼠标操作的方法封装在 ActionChains 类提供。")]),t._v(" "),a("p",[t._v("ActionChains 类提供了鼠标操作的常用方法：")]),t._v(" "),a("p",[a("strong",[t._v("perform()")]),t._v("： 执行所有 ActionChains 中存储的行为；")]),t._v(" "),a("p",[a("strong",[t._v("context_click()")]),t._v("：  右击；")]),t._v(" "),a("p",[a("strong",[t._v("double_click()")]),t._v("：   双击；")]),t._v(" "),a("p",[a("strong",[t._v("drag_and_drop()")]),t._v("：  拖动；")]),t._v(" "),a("p",[a("strong",[t._v("move_to_element()")]),t._v("：鼠标悬停。")]),t._v(" "),a("p",[t._v("举个例子：")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 引入 ActionChains 类")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("common"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("action_chains "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" ActionChains\n\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Chrome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.baidu.cn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 定位到要悬停的元素")]),t._v("\nabove "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_link_text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"设置"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对定位到的元素执行鼠标悬停操作")]),t._v("\nActionChains"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("move_to_element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("above"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("perform"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("h2",{attrs:{id:"键盘事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#键盘事件"}},[t._v("#")]),t._v(" 键盘事件")]),t._v(" "),a("p",[t._v("以下为常用的键盘操作：")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("send_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BACK_SPACE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  删除键（BackSpace）\nsend_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SPACE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       空格键"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Space"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsend_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TAB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("         制表键"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Tab"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsend_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ESCAPE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("      回退键（Esc）\nsend_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ENTER"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("       回车键（Enter）\nsend_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CONTROL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" 全选（Ctrl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("A）\nsend_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CONTROL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'c'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" 复制（Ctrl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("C）\nsend_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CONTROL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'x'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" 剪切（Ctrl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("X）\nsend_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CONTROL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'v'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" 粘贴（Ctrl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("V）\nsend_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("F1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("          键盘 F1\nsend_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("F12"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("         键盘 F12\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输入框输入内容")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kw"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"seleniumm"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除多输入的一个 m")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kw"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BACK_SPACE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br")])]),a("h2",{attrs:{id:"获取断言信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取断言信息"}},[t._v("#")]),t._v(" 获取断言信息")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("title "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打印当前页面title")]),t._v("\nnow_url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current_url "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打印当前页面URL")]),t._v("\nuser "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_class_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'nums'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取结果数目")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h2",{attrs:{id:"等待页面加载完成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#等待页面加载完成"}},[t._v("#")]),t._v(" 等待页面加载完成")]),t._v(" "),a("h3",{attrs:{id:"显性等待"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#显性等待"}},[t._v("#")]),t._v(" 显性等待")]),t._v(" "),a("p",[t._v("显式等待使WebdDriver等待某个条件成立时继续执行，否则在达到最大时长时抛出超时异常（TimeoutException）。")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("common"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("by "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" By\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ui "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" WebDriverWait\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" expected_conditions "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" EC\n\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Firefox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.baidu.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nelement "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WebDriverWait"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("until"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                      EC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("presence_of_element_located"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("By"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kw"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nelement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'selenium'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("p",[t._v("WebDriverWait类是由WebDirver 提供的等待方法。在设置时间内，默认每隔一段时间检测一次当前页面元素是否存在，如果超过设置时间检测不到则抛出异常。具体格式如下：")]),t._v(" "),a("p",[a("strong",[a("code",[t._v("WebDriverWait(driver, timeout, poll_frequency=0.5, ignored_exceptions=None)")])])]),t._v(" "),a("p",[a("strong",[t._v("driver")]),t._v("：浏览器驱动。")]),t._v(" "),a("p",[a("strong",[t._v("timeout")]),t._v("：最长超时时间，默认以秒为单位。")]),t._v(" "),a("p",[a("strong",[t._v("poll_frequency")]),t._v("：检测的间隔（步长）时间，默认为0.5S。")]),t._v(" "),a("p",[a("strong",[t._v("ignored_exceptions")]),t._v("：超时后的异常信息，默认情况下抛NoSuchElementException异常。")]),t._v(" "),a("p",[a("strong",[t._v("WebDriverWait()")]),t._v("：一般由until()或until_not()方法配合使用")]),t._v(" "),a("p",[t._v("下面是until()和until_not()方法的说明\n"),a("strong",[t._v("until(method, message=‘’)")]),t._v(" 调用该方法提供的驱动程序作为一个参数，直到返回值为True。")]),t._v(" "),a("p",[a("strong",[t._v("until_not(method, message=‘’)")]),t._v(" 调用该方法提供的驱动程序作为一个参数，直到返回值为False。")]),t._v(" "),a("p",[t._v("在本例中，通过as关键字将expected_conditions 重命名为EC，并调用**presence_of_element_located()**方法判断元素是否存在。")]),t._v(" "),a("h3",{attrs:{id:"隐式等待"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#隐式等待"}},[t._v("#")]),t._v(" 隐式等待")]),t._v(" "),a("p",[t._v("如果某些元素不是立即可用的，隐式等待是告诉WebDriver去等待一定的时间后去查找元素。 默认等待时间是0秒，一旦设置该值，隐式等待是设置该WebDriver的实例的生命周期。")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Firefox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    \ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("implicitly_wait"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# seconds    ")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://somedomain/url_that_delays_loading"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    \nmyDynamicElement "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myDynamicElement"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h2",{attrs:{id:"在不同的窗口和框架之间移动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在不同的窗口和框架之间移动"}},[t._v("#")]),t._v(" 在不同的窗口和框架之间移动")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to_window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"windowName"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to_frame"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"frameName"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("以直接取表单的id 或name属性。如果iframe没有可用的id和name属性，则可以通过下面的方式进行定位。")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("#先通过xpth定位到iframe\nxf = driver.find_element_by_xpath('//*[@id=\"x-URS-iframe\"]')\n\n#再将定位对象传给switch_to_frame()方法\ndriver.switch_to_frame(xf)\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("一旦我们完成了frame中的工作，我们可以这样返回父frame:")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("driver.switch_to_default_content()\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h2",{attrs:{id:"警告框处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#警告框处理"}},[t._v("#")]),t._v(" 警告框处理")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("alert "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to_alert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[a("strong",[t._v("text")]),t._v("：返回 alert/confirm/prompt 中的文字信息。\n"),a("strong",[t._v("accept()")]),t._v("：接受现有警告框。\n"),a("strong",[t._v("dismiss()")]),t._v("：解散现有警告框。\n"),a("strong",[t._v("send_keys(keysToSend)")]),t._v("：发送文本至警告框。keysToSend：将文本发送至警告框。")]),t._v(" "),a("h2",{attrs:{id:"下拉框选择"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下拉框选择"}},[t._v("#")]),t._v(" 下拉框选择")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("select "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Select\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" time "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sleep\n\ndriver "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Chrome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("implicitly_wait"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://www.baidu.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsel "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_xpath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"//select[@id='nr']\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nSelect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("select_by_value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'50'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 显示50条")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("h2",{attrs:{id:"文件上传"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件上传"}},[t._v("#")]),t._v(" 文件上传")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 定位上传按钮，添加本地文件")]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'D:\\\\upload_file.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"cookie操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cookie操作"}},[t._v("#")]),t._v(" cookie操作")]),t._v(" "),a("p",[t._v("WebDriver操作cookie的方法：")]),t._v(" "),a("p",[a("strong",[t._v("get_cookies()")]),t._v("： 获得所有cookie信息。")]),t._v(" "),a("p",[a("strong",[t._v("get_cookie(name)")]),t._v("： 返回字典的key为“name”的cookie信息。")]),t._v(" "),a("p",[a("strong",[t._v("add_cookie(cookie_dict)")]),t._v(" ： 添加cookie。“cookie_dict”指字典对象，必须有name 和value 值。")]),t._v(" "),a("p",[a("strong",[t._v("delete_cookie(name,optionsString)")]),t._v("：删除cookie信息。“name”是要删除的cookie的名称，“optionsString”是该cookie的选项，目前支持的选项包括“路径”，“域”。")]),t._v(" "),a("p",[a("strong",[t._v("delete_all_cookies()")]),t._v("： 删除所有cookie信息")]),t._v(" "),a("h2",{attrs:{id:"调用javascript代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调用javascript代码"}},[t._v("#")]),t._v(" 调用JavaScript代码")]),t._v(" "),a("p",[t._v("通过**execute_script()**方法执行JavaScripts代码来移动滚动条的位置。")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("js"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"window.scrollTo(100,450);"')]),t._v("\ndriver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute_script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过javascript设置浏览器窗口的滚动条位置")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"窗口截图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#窗口截图"}},[t._v("#")]),t._v(" 窗口截图")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_screenshot_as_file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D:\\\\baidu_img.jpg"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 截取当前窗口，并指定截图图片的保存位置")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"关闭浏览器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭浏览器"}},[t._v("#")]),t._v(" 关闭浏览器")]),t._v(" "),a("p",[a("strong",[t._v("close()")]),t._v(" 关闭单个窗口")]),t._v(" "),a("p",[a("strong",[t._v("quit()")]),t._v(" 关闭所有窗口")]),t._v(" "),a("h2",{attrs:{id:"直接用cookie登录方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#直接用cookie登录方法"}},[t._v("#")]),t._v(" 直接用cookie登录方法")]),t._v(" "),a("ol",[a("li",[t._v("手动获取网页的cookie，将其序列化并存储在本地")]),t._v(" "),a("li",[t._v("写入代码")])]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" item "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" cookies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);